env:
    GH_USER: "ENCRYPTED[d123d1fe9fb371d1019a0f44cbc2dd4a1017cd234b583e818fcff1166ab5afb2fe078ec53695ff6707f7e95dd5d42d0d]"
    GH_EMAIL: "ENCRYPTED[a0218421ee4c8acacb228d79b1205fc9e6dc4c310930cf433c06003551e7c836d87e9ee068ccd1c29699ea323a7ad255]"
    GH_TOKEN: "ENCRYPTED[8f6fdf08ef5f9a40ec51aeadff78291cae03beef33484ddbf673a09bd02085d57b87d9fe99add0864c206a4146bc040c]"
    TG_CHAT: "ENCRYPTED[01deeab78ac6d29ce06a69a1b23e59f04e7d41dd88d29c23f7ae12cc77db0004744aa767de6b16d91b7726663ad90a13]"
    TG_TOKEN: "ENCRYPTED[c8bd3a48bd0c16c6232fae2484693bc230a19cec11f70ec1ff57c3cb20dd3397fa5ec3d92473e6e21c32bd4885c20375]"
    SF_USER: "ENCRYPTED[20fd08b51d5f97df6840b1c4916ca80cf84ccf326c46ff2e6ec14170db73879e17fc260e9881f2f16314b9fc93850173]"
    SF_PASS: "ENCRYPTED[5961dbf0c6b81e82a475001fad991f0fbf6be12b9189cf8333b9128103eae94fc70b170e75e849621c0417e6856d0674]"

task:
  name: "AOSP Build"
  timeout_in: 4h
  container:
      image: kizziama/ubuntu:latest
      cpu: 8
      memory: 32G

  rclone_setup_script:
      - mkdir -p ~/.config/rclone
      - curl -so ~/.config/rclone/rclone.conf https://$GH_TOKEN@raw.githubusercontent.com/$GH_USER/misc/main/rclone.conf

  git_setup_script:
      - git config --global user.name "$GH_USER"
      - git config --global user.email "$GH_EMAIL"
      - echo "https://$GH_USER:$GH_TOKEN@github.com" > ~/.git-credentials
      - git config --global credential.helper "store --file ~/.git-credentials"

  ccache_stats_script:
      - ccache -s

  build_start_script:
      - curl https://$GH_TOKEN@raw.githubusercontent.com/$GH_USER/misc/main/build.sh > build.sh
      - bash build.sh
